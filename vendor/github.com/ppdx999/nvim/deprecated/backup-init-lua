-- encoding
vim.o.encofing = 'utf-8'
vim.scriptencoding = 'utf-8'

-- visual
vim.o.ambiwidth = 'double'
vim.o.tabstop = 2
vim.o.softtabstop = 2
vim.o.shiftwidth = 2
vim.o.expandtab = true
vim.o.autoindent = true
vim.o.smartindent = true

vim.o.visualbell = true
vim.o.number = true
vim.o.showmatch = true
vim.o.matchtime = 1
vim.o.wrap = false

-- search
vim.o.incsearch = true
vim.o.ignorecase = true
vim.o.smartcase = true
vim.o.hlsearch = true
vim.api.nvim_set_keymap('n', '<Esc><Esc>', ':nohl<CR>', { noremap = true, silent = true})

-- manipulation
vim.g.mapleader = ';'
vim.opt.clipboard:append{'unnamedplus'}
vim.o.ttimeout = true
vim.o.ttimeoutlen = 50

-- keymaps
vim.api.nvim_set_keymap("n", "<leader>w", ":w<CR>", { noremap = true, silent = true })
vim.api.nvim_set_keymap("n", "<leader>q", ":q<CR>", { noremap = true, silent = true })
vim.api.nvim_set_keymap("n", "<leader>v", ":<c-u>vs<cr>", { noremap = true, silent = true })
vim.api.nvim_set_keymap("n", "<c-h>", "<c-w><c-h>", { noremap = true, silent = true })
vim.api.nvim_set_keymap("n", "<c-j>", "<c-w><c-j>", { noremap = true, silent = true })
vim.api.nvim_set_keymap("n", "<c-k>", "<c-w><c-k>", { noremap = true, silent = true })
vim.api.nvim_set_keymap("n", "<c-l>", "<c-w><c-l>", { noremap = true, silent = true })
vim.api.nvim_set_keymap("n", "]b", ":bnext<CR>", { noremap = true, silent = true })
vim.api.nvim_set_keymap("n", "[b", ":bprevious<CR>", { noremap = true, silent = true })
vim.api.nvim_set_keymap("n", "tt", ":tabnew<CR>", { noremap = true, silent = true })
vim.api.nvim_set_keymap("n", "]t", ":tabnext<CR>", { noremap = true, silent = true })
vim.api.nvim_set_keymap("n", "[t", ":tabprevious<CR>", { noremap = true, silent = true })

-- plugins

local dein_dir = vim.fn.expand('~/.cache/dein')
local dein_repo_dir = dein_dir .. '/repos/github.com/Shougo/dein.vim'
local rc_dir = vim.fn.expand('~/.config/nvim')

if vim.fn.isdirectory(dein_repo_dir) ~= 1 then
  print('will install dein.vim')
  vim.fn.system({'git', 'clone', 'https://github.com/Shougo/dein.vim', dein_repo_dir})
end

vim.o.runtimepath = dein_repo_dir .. ',' .. vim.o.runtimepath

if vim.fn['dein#load_state'](dein_dir) ~= -1 then
  vim.fn['dein#begin'](dein_dir)

  local toml = rc_dir .. '/dein.toml'
  local lazy_toml = rc_dir .. '/dein_lazy.toml'

  vim.fn['dein#load_toml'](toml, {lazy = 0})
  vim.fn['dein#load_toml'](lazy_toml, {lazy = 1})

  vim.fn['dein#end']()
  vim.fn['dein#save_state']()
end

vim.cmd('filetype plugin indent on')

if vim.fn['dein#check_install']() > 0 then
  print('will install plugin')
  vim.fn['dein#install']()
end
